name: Release
on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

jobs:
  trigger:
    name: Trigger
    runs-on: macos-latest
    steps:
      # Checks-out your repository under $GITHUB_WORKSPACE, so your job can access it
      - uses: actions/checkout@v2
      - uses: webfactory/ssh-agent@v0.5.3
        with:
          ssh-private-key: ${{ secrets.TRIGGER_SSH_PRIVATE_KEY }}
      - run: brew install gnu-sed
      - run: |
          git log -1 --pretty=%B | pbcopy
          pbpaste
          rm -rf .git/
          rm -rf .github/
          cd ..
          git clone git@github.com:valora-inc/wallet-release.git
          cp -a wallet/. wallet-release/
          cd wallet-release
          git add -A
          pbpaste | git commit -F -
          git push
